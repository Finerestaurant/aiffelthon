
Loading dataset...
batch_size = 16
learning rate = 0.0001
train_size = 65372
validation_size = 18677
test_size = 9340
Data load complete!
Initializing model....
Initialize complete!!
[3m                                   SampleCNN Summary                                    
┏━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃[1m path         [22m┃[1m outputs                [22m┃[1m batch_stats        [22m┃[1m params                  [22m┃
┡━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Inputs       │ float32[16,48,1876]    │                    │                         │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_0  │ float32[16,46,625,128] │ mean: float32[128] │ bias: float32[128]      │
│              │                        │ var: float32[128]  │ scale: float32[128]     │
│              │                        │                    │                         │
│              │                        │ [1m256 (1.0 KB)[22m       │ [1m256 (1.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_1  │ float32[16,44,312,128] │ mean: float32[128] │ bias: float32[128]      │
│              │                        │ var: float32[128]  │ scale: float32[128]     │
│              │                        │                    │                         │
│              │                        │ [1m256 (1.0 KB)[22m       │ [1m256 (1.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_10 │ float32[16,8,8,256]    │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_2  │ float32[16,42,155,128] │ mean: float32[128] │ bias: float32[128]      │
│              │                        │ var: float32[128]  │ scale: float32[128]     │
│              │                        │                    │                         │
│              │                        │ [1m256 (1.0 KB)[22m       │ [1m256 (1.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_3  │ float32[16,40,77,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_4  │ float32[16,38,38,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_5  │ float32[16,18,18,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_6  │ float32[16,16,16,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_7  │ float32[16,14,14,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_8  │ float32[16,12,12,256]  │ mean: float32[256] │ bias: float32[256]      │
│              │                        │ var: float32[256]  │ scale: float32[256]     │
│              │                        │                    │                         │
│              │                        │ [1m512 (2.0 KB)[22m       │ [1m512 (2.0 KB)[22m            │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ BatchNorm_9  │ float32[16,10,10,512]  │ mean: float32[512] │ bias: float32[512]      │
│              │                        │ var: float32[512]  │ scale: float32[512]     │
│              │                        │                    │                         │
│              │                        │ [1m1,024 (4.1 KB)[22m     │ [1m1,024 (4.1 KB)[22m          │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_0       │ float32[16,46,625,128] │                    │ bias: float32[128]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,1,128]      │
│              │                        │                    │                         │
│              │                        │                    │ [1m1,280 (5.1 KB)[22m          │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_1       │ float32[16,44,312,128] │                    │ bias: float32[128]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,128,128]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m147,584 (590.3 KB)[22m      │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_10      │ float32[16,8,8,256]    │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,512,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m1,179,904 (4.7 MB)[22m      │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_2       │ float32[16,42,155,128] │                    │ bias: float32[128]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,128,128]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m147,584 (590.3 KB)[22m      │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_3       │ float32[16,40,77,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,128,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m295,168 (1.2 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_4       │ float32[16,38,38,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m590,080 (2.4 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_5       │ float32[16,18,18,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m590,080 (2.4 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_6       │ float32[16,16,16,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m590,080 (2.4 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_7       │ float32[16,14,14,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m590,080 (2.4 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_8       │ float32[16,12,12,256]  │                    │ bias: float32[256]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,256]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m590,080 (2.4 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Conv_9       │ float32[16,10,10,512]  │                    │ bias: float32[512]      │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[3,3,256,512]    │
│              │                        │                    │                         │
│              │                        │                    │ [1m1,180,160 (4.7 MB)[22m      │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Dense_0      │ float32[16,30]         │                    │ bias: float32[30]       │
│              │                        │                    │ kernel:                 │
│              │                        │                    │ float32[16384,30]       │
│              │                        │                    │                         │
│              │                        │                    │ [1m491,550 (2.0 MB)[22m        │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Dropout_0    │ float32[16,16,16,256]  │                    │                         │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ Dropout_1    │ float32[16,8,8,256]    │                    │                         │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│ SampleCNN    │ float32[16,30]         │                    │                         │
├──────────────┼────────────────────────┼────────────────────┼─────────────────────────┤
│[1m              [22m│[1m                  Total [22m│[1m 5,376 (21.5 KB)    [22m│[1m 6,399,006 (25.6 MB)     [22m│
└──────────────┴────────────────────────┴────────────────────┴─────────────────────────┘
[1m                                                                                        
[1m                         Total Parameters: 6,404,382 (25.6 MB)                          
Epoch 1
Traceback (most recent call last):
  File "SampleCNN_main.py", line 149, in <module>
    validation_loss, validation_accuracy = eval_step(state, validation_x, validation_y, dropout_rng=rng)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/api.py", line 527, in cache_miss
    out_flat = xla.xla_call(
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 1937, in bind
    return call_bind(self, fun, *args, **params)
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 1953, in call_bind
    outs = top_trace.process_call(primitive, fun_, tracers, params)
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 687, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 208, in _xla_call_impl
    compiled_fun = xla_callable(fun, device, backend, name, donated_invars,
  File "/usr/local/lib/python3.8/dist-packages/jax/linear_util.py", line 295, in memoized_fun
    ans = call(fun, *args)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 257, in _xla_callable_uncached
    return lower_xla_callable(fun, device, backend, name, donated_invars, False,
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/profiler.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 302, in lower_xla_callable
    jaxpr, out_type, consts = pe.trace_to_jaxpr_final2(
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/profiler.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/partial_eval.py", line 2188, in trace_to_jaxpr_final2
    jaxpr, out_type, consts = trace_to_subjaxpr_dynamic2(fun, main, debug_info)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/partial_eval.py", line 2138, in trace_to_subjaxpr_dynamic2
    ans = fun.call_wrapped(*in_tracers_)
  File "/usr/local/lib/python3.8/dist-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "SampleCNN_main.py", line 73, in eval_step
    logits = SampleCNN().apply(params,
jax._src.traceback_util.UnfilteredStackTrace: NameError: name 'params' is not defined
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "SampleCNN_main.py", line 149, in <module>
    validation_loss, validation_accuracy = eval_step(state, validation_x, validation_y, dropout_rng=rng)
  File "SampleCNN_main.py", line 73, in eval_step
    logits = SampleCNN().apply(params,
NameError: name 'params' is not defined
Traceback (most recent call last):
  File "SampleCNN_main.py", line 149, in <module>
    validation_loss, validation_accuracy = eval_step(state, validation_x, validation_y, dropout_rng=rng)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/api.py", line 527, in cache_miss
    out_flat = xla.xla_call(
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 1937, in bind
    return call_bind(self, fun, *args, **params)
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 1953, in call_bind
    outs = top_trace.process_call(primitive, fun_, tracers, params)
  File "/usr/local/lib/python3.8/dist-packages/jax/core.py", line 687, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 208, in _xla_call_impl
    compiled_fun = xla_callable(fun, device, backend, name, donated_invars,
  File "/usr/local/lib/python3.8/dist-packages/jax/linear_util.py", line 295, in memoized_fun
    ans = call(fun, *args)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 257, in _xla_callable_uncached
    return lower_xla_callable(fun, device, backend, name, donated_invars, False,
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/profiler.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/dispatch.py", line 302, in lower_xla_callable
    jaxpr, out_type, consts = pe.trace_to_jaxpr_final2(
  File "/usr/local/lib/python3.8/dist-packages/jax/_src/profiler.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/partial_eval.py", line 2188, in trace_to_jaxpr_final2
    jaxpr, out_type, consts = trace_to_subjaxpr_dynamic2(fun, main, debug_info)
  File "/usr/local/lib/python3.8/dist-packages/jax/interpreters/partial_eval.py", line 2138, in trace_to_subjaxpr_dynamic2
    ans = fun.call_wrapped(*in_tracers_)
  File "/usr/local/lib/python3.8/dist-packages/jax/linear_util.py", line 168, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
  File "SampleCNN_main.py", line 73, in eval_step
    logits = SampleCNN().apply(params,
jax._src.traceback_util.UnfilteredStackTrace: NameError: name 'params' is not defined
The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.
--------------------
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "SampleCNN_main.py", line 149, in <module>
    validation_loss, validation_accuracy = eval_step(state, validation_x, validation_y, dropout_rng=rng)
  File "SampleCNN_main.py", line 73, in eval_step
    logits = SampleCNN().apply(params,
NameError: name 'params' is not defined